<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Simulación Best Fit</title>
  <link rel="stylesheet" href="../../style.css">
</head>
<body>
  <header class="main-header">
    <h1>Algoritmo Best Fit</h1>
  </header>

  <main class="container">
    <!-- Aquí va tu simulación Best Fit -->
    <div id="bestfit-app">
      <div id="bestfit-app">
  <section class="panel">
    <h2>Simulación Best Fit</h2>

    <label>Memoria (bloques separados por coma):</label><br>
    <input id="memBest" value="100,200,300,400"><br><br>

    <label>Procesos (tamaños separados por coma):</label><br>
    <input id="procBest" value="120,80,250,90"><br><br>

    <button onclick="simulateBestFit()">Simular Best Fit</button>

    <div id="bestMemory" class="memory"></div>
    <div class="results" id="bestResults"></div>
    <div id="bestTable"></div>
  </section>
</div>

<script>
  function simulateBestFit() {
    const memInput = document.getElementById("memBest").value.split(",").map(Number);
    const procInput = document.getElementById("procBest").value.split(",").map(Number);

    let memory = memInput.map(size => ({ size, free: size }));
    let allocations = [];

    procInput.forEach((p, idx) => {
      let chosenIndex = -1;
      let minWaste = Infinity;
      memory.forEach((block, i) => {
        if (block.free >= p && (block.free - p) < minWaste) {
          minWaste = block.free - p;
          chosenIndex = i;
        }
      });
      if (chosenIndex !== -1) {
        memory[chosenIndex].free -= p;
        allocations.push({ process: p, block: chosenIndex });
      } else {
        allocations.push({ process: p, block: null });
      }
    });

    renderBestMemory(memory, allocations);
    renderBestTable(allocations);
  }

  function renderBestMemory(memory, allocations) {
    const container = document.getElementById("bestMemory");
    container.innerHTML = "";
    memory.forEach((block, i) => {
      const div = document.createElement("div");
      div.className = "block " + (block.free < block.size ? "used" : "free");
      div.textContent = `Bloque ${i+1}: ${block.size - block.free}/${block.size} usado, ${block.free} libre`;
      container.appendChild(div);
    });

    let frag = memory.reduce((acc, b) => acc + b.free, 0);
    const results = document.getElementById("bestResults");
    results.innerHTML = `<strong>Fragmentación total:</strong> ${frag}`;
  }

  function renderBestTable(allocations) {
    const tableDiv = document.getElementById("bestTable");
    let html = "<table class='sim-table'><tr><th>Proceso</th><th>Bloque asignado</th></tr>";
    allocations.forEach((a, idx) => {
      html += `<tr>
        <td>P${idx+1} (${a.process})</td>
        <td>${a.block !== null ? "Bloque " + (a.block+1) : "No asignado"}</td>
      </tr>`;
    });
    html += "</table>";
    tableDiv.innerHTML = html;
  }
</script>


    </div>
  </main>

  <footer class="main-footer">
    <p><a href="../../index.html">Volver al menú principal</a></p>
  </footer>
</body>
</html>
